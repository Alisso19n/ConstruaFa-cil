<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Painel do Profissional | ConstruaFácil</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <style>
        body { background: linear-gradient(135deg, #eaf6fb 0%, #d5ecfa 100%); font-family: 'Segoe UI', Arial, sans-serif; margin: 0; min-height: 100vh; }
        .painel { max-width: 720px; margin: 30px auto; background: #fff; border-radius: 16px; box-shadow: 0 4px 22px rgba(44,160,255,0.13); padding: 34px 26px 26px; }
        .titulo { font-size: 1.5em; color: #3498db; font-weight: bold; margin-bottom: 18px; text-align: center; }
        .infos { text-align: center; margin-bottom: 22px; color: #555; word-break: break-word; }
        .msg-feedback { text-align: center; margin-bottom: 18px; font-weight: 500; font-size: 1em; color: #27ae60; }
        .acoes-perfil { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-bottom: 18px; }
        .botao { display: inline-block; padding: 12px 24px; border: none; border-radius: 7px; background: #3498db; color: #fff; font-weight: 700; text-decoration: none; cursor: pointer; transition: background .2s; }
        .botao:hover { background:#217dbb; }
        .editar{background:#27ae60}.editar:hover{background:#1e8449}
        .excluir{background:#e74c3c}.excluir:hover{background:#c0392b}
        table{width:100%;border-collapse:collapse;margin-top:18px;font-size:1em}
        th,td{border-bottom:1px solid #e3e3e3;padding:10px 6px;text-align:left}
        th{background:#e3f3fb;color:#2980b9;font-weight:600}
        .acao{padding:7px 16px;border:none;border-radius:7px;font-weight:700;cursor:pointer;margin-right:6px;margin-bottom:3px}
        .aceitar{background:#27ae60;color:#fff}.aceitar:hover{background:#219150}
        .recusar{background:#e74c3c;color:#fff}.recusar:hover{background:#c0392b}
        @media (max-width:700px){
            .painel{padding:10px 2vw 20px;max-width:99vw}
            table, thead, tbody, th, td, tr{display:block}
            thead tr{display:none}
            tbody tr{margin-bottom:20px;border-radius:8px;box-shadow:0 2px 12px rgba(44,160,255,0.06);background:#f9fbfc;padding:10px 0}
            td{position:relative;padding-left:48%;min-height:38px;border:none;border-bottom:1px solid #e3e3e3;margin-bottom:6px}
            td:before{position:absolute;top:10px;left:8px;width:45%;padding-right:6px;white-space:nowrap;color:#2980b9;font-weight:600;font-size:.97em}
            td:nth-of-type(1):before{content:"Cliente"}
            td:nth-of-type(2):before{content:"Descrição"}
            td:nth-of-type(3):before{content:"Data"}
            td:nth-of-type(4):before{content:"Status"}
            td:nth-of-type(5):before{content:"Ações"}
        }
    </style>
</head>
<body>
<div class="painel">
    <div class="titulo">Painel do Profissional</div>

    <div class="infos">
        Olá, <span th:text="${profissional.nome}">Nome Profissional</span>!<br>
        <span th:text="${profissional.email}">email@profissional.com</span> |
        <span th:text="${profissional.telefone}">(00) 00000-0000</span> |
        <span th:text="${profissional.profissao}">Profissão</span>
    </div>

    <div th:if="${param.editado}" class="msg-feedback">Seus dados foram atualizados com sucesso!</div>

    <div class="acoes-perfil">
        <a class="botao editar" th:href="@{/profissionais/editar}">Editar Dados</a>
        <a class="botao excluir" th:href="@{/profissionais/excluir}">Excluir Conta</a>
        <a class="botao" th:href="@{/solicitacoes/nova}">Solicitar Serviço</a>
        <a class="botao" th:href="@{/logout}" style="background:#c0392b;">Sair</a>
    </div>

    <h3 style="margin-top: 34px; color: #217dbb;">Solicitações Recebidas</h3>
    <table>
        <thead>
        <tr>
            <th>Cliente</th><th>Descrição</th><th>Data</th><th>Status</th><th>Ações</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="solicitacao : ${solicitacoes}">
            <td th:text="${solicitacao.cliente != null ? solicitacao.cliente.nome : '-'}">Cliente</td>
            <td th:text="${solicitacao.descricao}">Descrição</td>
            <td th:text="${#temporals.format(solicitacao.dataSolicitacao, 'dd/MM/yyyy HH:mm')}">01/07/2025</td>
            <td th:text="${solicitacao.status}">PENDENTE</td>
            <td>
                <form th:action="@{/solicitacoes/atualizar-status/{id}(id=${solicitacao.id})}" method="post" style="display:inline;">
                    <input type="hidden" name="status" value="ACEITA" />
                    <button type="submit" class="acao aceitar" th:disabled="${solicitacao.status != 'PENDENTE'}">Aceitar</button>
                </form>
                <form th:action="@{/solicitacoes/atualizar-status/{id}(id=${solicitacao.id})}" method="post" style="display:inline;">
                    <input type="hidden" name="status" value="RECUSADA" />
                    <button type="submit" class="acao recusar" th:disabled="${solicitacao.status != 'PENDENTE'}">Recusar</button>
                </form>
            </td>
        </tr>
        <tr th:if="${#lists.isEmpty(solicitacoes)}">
            <td colspan="5" style="text-align:center;">Nenhuma solicitação recebida.</td>
        </tr>
        </tbody>
    </table>
</div>
</body>
</html>
